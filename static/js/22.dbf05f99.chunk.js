(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1130:function(e,t){},1259:function(e,t,n){"use strict";n.r(t);var a=n(228),i=n(229),r=n(231),s=n(230),c=n(232),o=n(3),u=n.n(o),l=n(993),f=n(956),h=n(957),m=n(1036),d=n(958),p=n(959),v=n(1037),b=n(960),g=n(1099),E=n.n(g),y=n(1100),O=n(1257),k=n(905),w=n(1101),j=new(n(1260).a),S=function(){function e(){Object(a.a)(this,e)}return Object(i.a)(e,null,[{key:"connect",value:function(){return this.socket=w(k.a.WS_URL),this.socket.on("message",function(e){j.next(e)}),j.asObservable()}},{key:"pushMessage",value:function(e){this.socket.emit("message",e)}}]),e}(),x=n(904),D=function(){function e(){Object(a.a)(this,e),this.subscribeToTimer=S}return Object(i.a)(e,[{key:"getDevice",value:function(){return new Promise(function(e,t){x.a.http({url:k.a.DEVICE_URL}).GET.then(function(t){e(t.data)}).catch(function(e){t(e)})})}},{key:"useVoucher",value:function(e){var t={devicename:x.a.getDeviceDetails().getDeviceName()||"unknown",deviceos:x.a.getDeviceDetails().getDeviceOS()||"unknown",vouchercode:e};return new Promise(function(e,n){x.a.http({url:"".concat(k.a.VOUCHER_URL,"/manage"),data:t}).POST.then(function(t){e(t.data.message)}).catch(function(e){n(e)})})}}]),e}(),U=n(1246),P=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).pisoWifiService=new D,n.state={days:0,minutes:0,hours:0,seconds:0,diff:0},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"load",value:function(){var e=this;this.timer=Object(O.a)(1e3).pipe(Object(U.a)(Object(y.a)(E.a.mark(function t(){var n;return E.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.pisoWifiService.getDevice();case 2:0===(n=t.sent).servertime?e.setState(function(e){e.diff;return{diff:0}},function(){}):e.setState(function(e){e.diff;return{diff:n.servertime}});case 4:case"end":return t.stop()}},t)})))).subscribe(function(){var t=e.state.diff;e.days=Math.floor(t/86400),t%=86400,e.hours=Math.floor(t/3600),t%=3600,e.minutes=Math.floor(t/60),t%=60,e.seconds=Math.floor(t),e.setState({days:e.days,hours:e.hours,minutes:e.minutes,seconds:e.seconds,diff:t})})}},{key:"unload",value:function(){this.timer.unsubscribe()}},{key:"componentDidMount",value:function(){this.load()}},{key:"componentWillUnmount",value:function(){this.unload()}},{key:"render",value:function(){var e=this.state,t=e.minutes,n=e.seconds,a=e.hours,i=e.days,r=e.diff,s="".concat(i,":").concat(a,":").concat(t,":").concat(n<10?"0".concat(n):n);return u.a.createElement("h1",{className:"text-center",id:"renderTime"},0===r?"0:0:0:00":s)}}]),t}(o.Component),C=n(942),L=n.n(C),N=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).useVoucher=function(){L.a.fire({title:"Please provide your voucher",input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Use",showLoaderOnConfirm:!0,preConfirm:function(e){n.pisoWifiService.useVoucher(e).then(function(e){e&&L.a.fire({title:"Voucher",text:e,allowOutsideClick:!1}).then(function(){})}).catch(function(e){L.a.fire({title:"Error",text:"Something went wrong. Please try again."})})},allowOutsideClick:function(){return!L.a.isLoading()}})},n.onInsert=function(){n.setState(function(e){var t=e.done;e.insert;return t?{done:!1,insert:!0,progressValue:30}:(n.pushMessage(0),{done:!0,insert:!1,progressValue:30})})},n.pushMessage=function(e){n.pisoWifiService.subscribeToTimer.pushMessage(e)},n.pisoWifiService=new D,n.state={insert:!0,done:!1,progressValue:30,vouchercode:"",voucherInput:!1},n}return Object(c.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.socketSubscriber=this.pisoWifiService.subscribeToTimer.connect().subscribe(function(t){try{var n;"connected"===t.data&&(n=!0),0===t.data&&(n=!1),1==t.data&&(n=!0),"disconnected"==t.data&&(n=!0),2==t.data&&(n=!1),e.setState(function(e){var t=e.progressValue;return{insert:n,progressValue:t-1}}),0===e.state.progressValue&&e.setState({done:!1})}catch(a){console.error(a)}})}},{key:"componentWillUnmount",value:function(){this.socketSubscriber.unsubscribe()}},{key:"render",value:function(){return u.a.createElement("div",{className:"app flex-row align-items-center"},u.a.createElement(l.a,null,u.a.createElement(f.a,{className:"justify-content-center"},u.a.createElement(h.a,{md:"8"},u.a.createElement(m.a,null,u.a.createElement(d.a,{className:"p-4"},u.a.createElement(p.a,null,u.a.createElement(v.a,null,u.a.createElement("div",{className:"text-center"},u.a.createElement("svg",{id:"Component_2_1","data-name":"Component 2 \u2013 1",xmlns:"http://www.w3.org/2000/svg",width:"250",height:"100",viewBox:"0 0 557 100"},u.a.createElement("text",{id:"Piso",transform:"translate(0 76)",fill:"#0d0c0c","font-size":"100","font-family":"SitkaSmall-Bold, Sitka Small","font-weight":"700"},u.a.createElement("tspan",{x:"0",y:"0"},"Piso")),u.a.createElement("text",{id:"Konek",transform:"translate(225 76)",fill:"#00b1ff","font-size":"100","font-family":"SitkaSmall-Bold, Sitka Small","font-weight":"700"},u.a.createElement("tspan",{x:"0",y:"0"},"Konek")))),!this.state.insert&&this.state.done?u.a.createElement("p",{className:"text-muted text-center"},"Please insert coin one at a time"):"",u.a.createElement("br",null),u.a.createElement("br",null),u.a.createElement(P,null),u.a.createElement("br",null),u.a.createElement("br",null),u.a.createElement(f.a,null,this.state.insert?u.a.createElement(h.a,{xs:"12",className:"text-center"},u.a.createElement(b.a,{style:{padding:"10px",marginBottom:"8px"},color:this.state.insert?"danger":"success",className:"px-6 col-8",onClick:this.onInsert},this.state.insert?"Insert Coin":"Done")):u.a.createElement(h.a,{xs:"12",className:"text-center"},this.state.done?u.a.createElement("h3",{className:"text-center"},this.state.progressValue,"s"):""),u.a.createElement("br",null),u.a.createElement("br",null),this.state.insert?u.a.createElement(h.a,{xs:"12",className:"text-center"},u.a.createElement(b.a,{style:{padding:"10px"},color:"primary",className:"px-6 col-8",onClick:this.useVoucher},"Use Voucher")):"")))))))))}}]),t}(o.Component);t.default=N},904:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return p});var a=n(948),i=n(228),r=n(229),s=n(944),c=n.n(s),o=n(927),u=n.n(o),l=n(945),f=function(){function e(){Object(i.a)(this,e),this.parser=new l.UAParser}return Object(r.a)(e,[{key:"getDeviceName",value:function(){var e=this.parser.getDevice().vendor||"",t=this.parser.getDevice().model||"",n=this.parser.getDevice().type||"";return"".concat(e," ").concat(t," ").concat(n)}},{key:"getDeviceOS",value:function(){return this.parser.getOS().name+" "+this.parser.getOS().version}},{key:"getDeviceCPU",value:function(){return this.parser.getCPU()}},{key:"getDeviceEngine",value:function(){return this.parser.getEngine()}}]),e}(),h=function(){function e(){Object(i.a)(this,e)}return Object(r.a)(e,null,[{key:"http",value:function(e){return new m(e)}},{key:"getDeviceDetails",value:function(){return new f}},{key:"handleResponse",value:function(e){return new Promise(function(t,n){[401,403].includes(e.status)||t(e),[401,403].includes(e.status)?window.location.reload():t(e),t(e)})}},{key:"renderDateFormat",value:function(e){return u()(e).format("MMMM D, YYYY h:mm A")}}]),e}(),m=function(){function e(t){Object(i.a)(this,e),this.options=t}return Object(r.a)(e,[{key:"GET",get:function(){var e=this.options,t=Object(a.a)({},e.headers);return new Promise(function(n,a){c.a.get(e.url,{headers:t}).then(function(e){n(e)}).catch(function(e){a(e)})})}},{key:"POST",get:function(){var e={method:"POST",url:this.options.url,data:this.options.data,headers:Object(a.a)({},this.options.headers)};return new Promise(function(t,n){c.a.request(e).then(function(e){t(e)}).catch(function(e){n(e)})})}},{key:"DELETE",get:function(){var e={method:"DELETE",url:this.options.url,data:this.options.data,headers:Object(a.a)({},this.options.headers)};return new Promise(function(t,n){c.a.request(e).then(function(e){t(e)}).catch(function(e){n(e)})})}},{key:"PUT",get:function(){var e={method:"PUT",url:this.options.url,data:this.options.data,headers:Object(a.a)({},this.options.headers)};return new Promise(function(t,n){c.a.request(e).then(function(e){t(e)}).catch(function(e){n(e)})})}}]),e}(),d=h,p=function(){function e(){Object(i.a)(this,e)}return Object(r.a)(e,null,[{key:"isEmpty",value:function(t){return"object"===typeof t?e.isEmptyObject(t):!t||"undefined"===t||""==t||" "==t||null===t}},{key:"isEmptyObject",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"removeNullKey",value:function(e){var t=Object.assign({},e);for(var n in t)t.hasOwnProperty(n)&&this.isEmpty(t[n])&&delete t[n];return t}}]),e}()},905:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a="http://10.0.0.1:5000/",i={LOGIN_URL:a+"api/admin/authenticate",DEVICE_URL:a+"api/device",VOUCHER_URL:a+"api/voucher",ADMIN_URL:a+"api/admin",MACHINE_URL:a+"api/machine",ROUTER_URL:a+"api/router",LOG_URL:a+"api/logs",COINSLOT_URL:a+"api/coinslot",WS_URL:"ws://10.0.0.1:5000/socket"}}}]);